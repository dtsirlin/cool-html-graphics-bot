// Generated by CoffeeScript 1.6.3
(function() {
  var Mouse, PI, animloop, canvas, cos, ctx, decay, frames, hypotenuse, pos, render, sin, sizeCanvasesToWindow, smoothMouse;

  pos = [];

  Mouse = {
    x: window.innerWidth / 2,
    y: window.innerHeight / 2,
    xA: [],
    yA: [],
    up: true,
    clicks: 0
  };

  Mouse.events = {};

  Mouse.events.move = function(e) {
    if ("touches" in e) {
      e = e.touches[0];
    }
    if (e.pageX === Mouse.x && e.pageY === Mouse.y) {
      return;
    }
    Mouse.x = (e.pageX + Mouse.x) * 0.5;
    return Mouse.y = (e.pageY + Mouse.y) * 0.5;
  };

  Mouse.avg = function(a, followSpeed, x, y) {
    if (!Array.isArray(pos[a])) {
      pos[a] = [Mouse.x, Mouse.y];
    }
    if (x > pos[a][0]) {
      pos[a][0] += (x - pos[a][0]) / followSpeed;
    } else if (x < pos[a][0]) {
      pos[a][0] -= (pos[a][0] - x) / followSpeed;
    } else {
      pos[a][0] += 0;
    }
    if (y > pos[a][1]) {
      pos[a][1] += (y - pos[a][1]) / followSpeed;
    } else if (y < pos[a][1]) {
      pos[a][1] -= (pos[a][1] - y) / followSpeed;
    } else {
      pos[a][1] += 0;
    }
    Mouse.xA[a] = Math.round(pos[a][0]);
    return Mouse.yA[a] = Math.round(pos[a][1]);
  };

  Mouse.events.up = function(e) {
    Mouse.down = false;
    return Mouse.up = true;
  };

  Mouse.events.down = function(e) {
    if ("touches" in e) {
      e.preventDefault();
      e = e.touches[0];
    }
    Mouse.down = true;
    Mouse.up = false;
    return Mouse.clicks += 1;
  };

  smoothMouse = function(headSpeed, tailSpeed) {
    var i, smoothMouse_id;
    Mouse.avg(0, 30, Mouse.x, Mouse.y);
    i = 1;
    while (i <= 64) {
      Mouse.avg(i, 3, Mouse.xA[i - 1], Mouse.yA[i - 1]);
      i++;
    }
    window.Mouse = Mouse;
    return smoothMouse_id = requestAnimationFrame(smoothMouse);
  };

  smoothMouse();

  document.addEventListener("mousemove", Mouse.events.move);

  document.addEventListener("touchmove", Mouse.events.move);

  document.addEventListener("mousedown", Mouse.events.down);

  document.addEventListener("touchstart", Mouse.events.down);

  document.addEventListener("touchend", Mouse.events.up);

  document.addEventListener("mouseup", Mouse.events.up);

  hypotenuse = function(a, b) {
    return Math.sqrt(a * a + b * b);
  };

  canvas = document.getElementById('canvas');

  ctx = canvas.getContext('2d');

  sizeCanvasesToWindow = function(event, zoom) {
    var canvasCopy, contextCopy, d, e, g, height, oh, ow, w, width;
    if (zoom == null) {
      zoom = 1;
    }
    w = window;
    d = document;
    e = d.documentElement;
    g = d.getElementsByTagName('body')[0];
    width = w.innerWidth || e.clientWidth || g.clientWidth;
    height = w.innerHeight || e.clientHeight || g.clientHeight;
    ow = canvas.width;
    oh = canvas.height;
    canvasCopy = document.createElement('canvas');
    contextCopy = canvasCopy.getContext('2d');
    canvasCopy.width = ow;
    canvasCopy.height = oh;
    contextCopy.drawImage(canvas, 0, 0);
    canvas.width = width / zoom;
    canvas.height = height / zoom;
    canvas.hypotenuse = hypotenuse(canvas.width, canvas.height);
    ctx.drawImage(canvasCopy, 0, 0, width / zoom, height / zoom);
    canvas.style.zoom = zoom;
    canvas.style.MozTransformOrigin = "0 0";
    return canvas.style.MozTransform = "scale(" + zoom + ", " + zoom + ")";
  };

  sizeCanvasesToWindow(null, 1);

  window.addEventListener('resize', sizeCanvasesToWindow, false);

  window.addEventListener('onorientationchange', sizeCanvasesToWindow, false);

  canvas.style.background = 'black';

  PI = Math.PI;

  sin = function(a) {
    return Math.sin(a);
  };

  cos = function(a) {
    return Math.cos(a);
  };

  frames = 0;

  decay = function(h, v, s, r) {
    var dh, dw, dx, dy;
    ctx.save();
    ctx.translate(canvas.width / 2 + h, canvas.height / 2 + v);
    if (r !== 0) {
      ctx.rotate(r);
    }
    dx = -(canvas.width + s) / 2;
    dy = -(canvas.height + s) / 2;
    dw = canvas.width + s;
    dh = canvas.height + s;
    ctx.drawImage(canvas, dx, dy, dw, dh);
    return ctx.restore();
  };

  render = function() {
    var alpha, d_x, d_y, radius, rotate_one, rotate_rate, rotate_three, rotate_two, size, thickness, translate_rate, x, y;
    x = Mouse.xA[12];
    y = Mouse.yA[12];
    size = 90;
    rotate_rate = 240;
    translate_rate = 240;
    radius = 60;
    alpha = 0.05;
    thickness = 4;
    rotate_one = frames / rotate_rate;
    rotate_two = frames / rotate_rate + 2 * PI / 3;
    rotate_three = frames / rotate_rate + 4 * PI / 3;
    ctx.save();
    ctx.translate(Mouse.xA[12], Mouse.yA[12]);
    ctx.translate(radius * sin(frames / translate_rate), radius * cos(frames / translate_rate));
    ctx.rotate(rotate_one);
    ctx.fillStyle = "hsla(50, 100%, 50%, " + alpha + ")";
    ctx.fillRect(-size / 2, -thickness / 2, size, thickness);
    ctx.restore();
    ctx.save();
    ctx.translate(Mouse.xA[24], Mouse.yA[24]);
    ctx.translate(radius * sin(frames / translate_rate + 2 * PI / 3), radius * cos(frames / translate_rate + 2 * PI / 3));
    ctx.rotate(rotate_two);
    ctx.fillStyle = "hsla(170, 100%, 50%, " + alpha + ")";
    ctx.fillRect(-size / 2, -thickness / 2, size, thickness);
    ctx.restore();
    ctx.save();
    ctx.translate(Mouse.xA[36], Mouse.yA[36]);
    ctx.translate(radius * sin(frames / translate_rate + 4 * PI / 3), radius * cos(frames / translate_rate + 4 * PI / 3));
    ctx.rotate(rotate_three);
    ctx.fillStyle = "hsla(290, 100%, 50%, " + alpha + ")";
    ctx.fillRect(-size / 2, -thickness / 2, size, thickness);
    ctx.restore();
    d_x = -(Mouse.xA[12] / canvas.width - 0.5) * 0.5;
    d_y = -(Mouse.yA[12] / canvas.height - 0.5) * 0.5;
    return decay(d_x, d_y, 0.75, 0);
  };

  ctx.fillStyle = 'black';

  ctx.fillRect(0, 0, canvas.width, canvas.height);

  (animloop = function() {
    var animloop_id;
    animloop_id = requestAnimationFrame(animloop);
    frames++;
    if (Mouse.down) {
      ctx.fillStyle = 'hsla(0,0%,0%,0.05)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
    }
    return render();
  })();

}).call(this);

/*
//@ sourceMappingURL=03.map
*/
